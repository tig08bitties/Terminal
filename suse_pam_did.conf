# =====================================================
# SUSE PAM Configuration for DID Authentication
# Integrated with Hedera Consensus Service and ZKP
# =====================================================

# /etc/pam.d/sshd (for SSH access to SUSE)
# Add these lines to enable DID authentication

# DID Authentication Module
auth    sufficient    pam_did.so \
    hedera_network=testnet \
    hedera_account=0.0.12345 \
    did_method=did:hedera: \
    zkp_enabled=true \
    covenant_verify=true

# Covenant Signature Verification
auth    required      pam_exec.so \
    /usr/local/bin/verify_covenant.sh

# Standard authentication as fallback
auth    sufficient    pam_unix.so

# Account management
account required      pam_unix.so

# Password management (for DID wallet unlock)
password sufficient   pam_did.so

# Session management with HCS logging
session required      pam_exec.so \
    /usr/local/bin/log_to_hedera.sh